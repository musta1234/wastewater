---
title: "ImportWastewater"
author: "Mustapha Mustapha"
date: "2024-03-06"
output: html_document
---
## This is a script that imports wastewater and hospitalization by country
  
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# April 2023: Undercounting COVID Cases
# clear R's brain
dir.create(tempdir()) # solve Error in file(out, "wt") : cannot open the connection
rm( list = ls())
# load libraries
preq = c( "tidyverse","ggpmisc", "gridExtra", "ggfortify", "scales", 
          "readxl", "readr", "stats", "haven", "Matrix", "foreign",
          "zoo", "prophet", "corrr", "broom", "usethis", "rvest")
#for (y in preq) install.packages(y, dep = TRUE)
sapply(preq, library, character.only=T)
```

```{r global_variables, echo=TRUE}

#rm( list = ls())
#file_loc <- "C:/Users/mustam23/OneDrive\ -\ Pfizer/Documents/Projects/wastewater/"
file_loc <- paste0(getwd())
data_loc <- paste0(file_loc, "/data_downloads/") # a location for data files 
# check if the string contains "mustam23"
work_laptop <- grepl("mustam23", getwd())
```
#below is a list of all files we want to import and modify

```{r define_filenames, echo=TRUE}

# <- "Austria 20240304 dl_blverlauf.csv"
ww_aus <- "Austria 20240304 dl_natmon_01.csv"
hosp_aus <- "Austria 20240304 SARI_Wohnregion_Patient_v202307.csv"
cases_can <- "Canada 20240304 covid19-download.csv"
ww_can <- "Canada 20240306 covid19-wastewater.csv"

hosp2_usa <- "data_table_for_currently_hospitalized_covid19_patients_-_the_united_states.csv"
hosp_usa <- "data_table_for_weekly_covid19_hospital_admissions_-_the_united_states.csv"
death_usa <- "data_table_for_weekly_deaths__the_united_states.csv"
ww_dk <- "Denmark 2024-02-28_dk_wastewater_data.csv"
cases_dk <- "Denmark 20240304 03_confirmed_cases_dead_admitted_sex.csv"
hosp_dk <- "Denmark 20240304 06_new_admissions_region_day.csv"
cases2_dk <- "Denmark 20240304 08_confirmed_cases_regions.csv"
 <- "Finland 20240304 Coronavirus wastewater monitoring weekly report.csv"
 <- "Finland 20240304 fact_epirapo_respinfcare.csv"

 <- "Netherlands 20240304 COVID-19_rioolwaterdata.csv"
 <- "Scotland RNAMonitoring_Public - Result Description - N1 Gene, Reported Value - N1 Gene (gc-l), Days Since.csv"
 <- "Sweden 2024 SLU_wastewater_data.csv"
 <- "Sweden SLU_COVID_collection_sites.xlsx"
 <- "United States 20240305 wastewater_surveillance_viral_activity_level_over_time_data.csv"
```



```{r import_bigfile, echo=TRUE}
# read the big file
bigfile <- read.csv(paste0(data_loc, "/bigfile.csv"))
    #select all date columns and convert them to date
    selected_columns <- names(bigfile)[grep("start_|end_|date", names(bigfile))]
    bigfile <- bigfile %>% mutate_at(selected_columns, ymd) 
```

```{r import_IHME, echo=TRUE}

